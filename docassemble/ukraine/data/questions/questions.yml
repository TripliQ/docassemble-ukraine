objects:
  - applicant: Individual
  - life_partner: Individual
  - children: DAList.using(object_type=Individual, ask_number=True)
---
segment id: Interview Started
ga id: Interview Started
question: |
  Application for residence title according to § 24 AufenthaltsG
subquestion: |
  ${ static_image('undraw_onboarding_re_6osc.svg', width='70%') }
continue button field: intro_screen
section: start
---
segment:
  id: Language Chosen
question: |
  Language settings
subquestion: |
  Please choose your language
  (Будь ласка, виберіть свою мову).
field: selected_language
choices:
  - English/англійська: en
  - Ukranian/Українка: uk
  - Deutsch/німецький: de
default: en
---
ssegment:
  id: Question Asked
  arguments:
    count: True
    question: Person Details
question: |
  Please complete the details about yourself.
fields:
  - First Name: applicant.name.first
    default: Iryna
  - Last Name / Birthname: applicant.name.last
    default: Bondarenko
  - Residence (Address): applicant.address.address
    default: Astronomicheskaya 22
  - Residence (Postal Code): applicant.address.postal_code
    default: 12345
  - Residence (City): applicant.address.city
    default: Kharkov
  - Residence (Country): applicant.country
    code: |
      countries_list()
    default: Ukraine
  - Date of birth: applicant.birthdate
    datatype: date
    default: ${ format_date(today(), format='yyyy-MM-dd') }
  - Place of birth: applicant.place_of_birth
    default: Kharkov
  - Country of birth: applicant.country_of_birth
    code: |
      countries_list()
    default: Ukraine
  - Gender: applicant.gender
    choices:
      - Male: Männlich
      - Female: Weiblich
    default: Female
  - Eye Color: applicant.eye_color
    choices:
      - Blue: Blau
      - Green: Grün
      - Gray: Grau
      - Brown: Braun
    default: Brown
  - Height: applicant.height
    datatype: integer
    default: 170
  - Nationality: applicant.nationality
    code: |
      countries_list()
    default: Ukraine
  - Previous nationality (only applicable if you had a different nationality before): applicant.previous_nationality
    code: |
      countries_list()
    default: Ukraine
  - Marital status: applicant.marital_status
    choices:
      - Single: ledig
      - Married: verheiratet
      - Living seperately: getreent lebend
      - Living in registered partnership: in eingetragener Lebenspartnerschaft lebend
      - Divorced: geschieden
      - Widowed: verwitwet
    default: ledig
  - Date of wedding/ registration: applicant.date_of_wedding
    datatype: date
    default: ${ format_date(today(), format='yyyy-MM-dd') }
  - Phone: applicant.phone
    default: +380 XXX XXX XXX
  - Email: applicant.email
    default: example@mail.com
progress: 10
section: section_personal_info
---
segment:
  id: Question Asked
  arguments:
    count: True
    question: Person ID Details
question: |
  Please complete the details about your passport or ID card
# TODO: What to do if no ID card?
fields:
  - Passport / ID card: applicant.passport_id
    choices:
      - Own Passport / ID card: eigener Pass/Ausweis
      - Registered with Father: eingetragen bei Vater
      - Registered with Mother: eingetragen bei Vater
    default: Own Passport / ID card
  - Type of ID: applicant.id_type
    choices:
      - Passport: Reisepass
      - ID Card: Ausweis
  - ID Number: applicant.id_number
    default: ABCDEFG12345
  - Issued on: applicant.id_issued_on
    datatype: date
    default: ${ format_date(today(), format='yyyy-MM-dd') }
  - Valid until: applicant.id_valid_until
    datatype: date
    default: ${ format_date(today(), format='yyyy-MM-dd') }
  - Issuing State: applicant.issuing_state
    code: |
      countries_list()
    default: Ukraine
progress: 20
section: secction_id_details
---
segment:
  id: Question Asked
  arguments:
    count: True
    question: Life Partner Details
question: |
  Please complete the details about your Spouse / registered life partner according to LPartG.
fields:
  - Do you have a spouse/registered partner who also wants to apply for a permission to stay?: life_partner_yes_no
    datatype: yesnoradio
    default: false
  - First Name: life_partner.name.first
    default: Iryna
    show if: life_partner_yes_no
  - Last Name / Birthname: life_partner.name.last
    default: Bondarenko
    show if: life_partner_yes_no
  - Date of birth: life_partner.birthdate
    datatype: date
    default: ${ format_date(today(), format='yyyy-MM-dd') }
    show if: life_partner_yes_no
  - Gender: life_partner.gender
    choices:
      - Male: Männlich
      - Female: Weiblich
    default: Female
    show if: life_partner_yes_no
  - Residence (Address): life_partner.address.address
    default: ${ applicant.address.address }
    show if: life_partner_yes_no
  - Residence (Postal Code): life_partner.address.postal_code
    default: ${ applicant.address.postal_code }
    show if: life_partner_yes_no
  - Residence (City): life_partner.address.city
    default: ${ applicant.address.city }
    show if: life_partner_yes_no
  - Residence (Country): life_partner.residence_state
    code: |
      countries_list()
    default: ${ applicant.country }
    show if: life_partner_yes_no
progress: 30
section: section_life_partner
---
segment:
  id: Question Asked
  arguments:
    count: True
    question: Number Children
question: |
  How many children came with you to Germany?
fields:
  - Number: children.target_number
    datatype: integer
    max: 4
    default: 0
progress: 40
section: section_children
---
segment:
  id: Question Asked
  arguments:
    count: True
    question: Children Details
question: |
  Please complete the info about your ${ ordinal(i) } child
fields:
  - First Name: children[i].name.first
    default: Iryna
  - Last Name: children[i].name.last
    default: Bondarenko
  - Date of birth: children[i].birthdate
    datatype: date
    default: ${ format_date(today(), format='yyyy-MM-dd') }
  - Place of birth: children[i].place_of_birth
    default: Kyiv
  # TODO: Should be multiple nationalities
  - Nationality: children[i].nationality
    code: |
      countries_list()
    default: Ukraine
  - Gender: children[i].gender
    choices:
      - Male: Männlich
      - Female: Weiblich
    default: Female
  - Residence (Address): children[i].address.address
    default: ${ applicant.address.address }
  - Residence (Postal Code): children[i].address.postal_code
    default: ${ applicant.address.postal_code }
  - Residence (City): children[i].address.city
    default: ${ applicant.address.city }
  - Residence (Country): children[i].residence_state
    code: |
      countries_list()
    default: ${ applicant.country }
progress: 50
section: section_children
---
segment:
  id: Question Asked
  arguments:
    count: True
    question: Arrival
question: |
  Please complete the following questions about your arrival
fields:
  - Entry to Germany: entry_date
    datatype: date
    default: ${ format_date(today(), format='yyyy-MM-dd') }
  - Entered with a visa: entry_visa_yes_no
    datatype: yesnoradio
  - Entry: entry_visa_type
    choices:
      - with Shengen visa: mit Schengener Visum
      - with national German visa: mit nationalen Deutschen Visum
    default: with national German visa
    show if: entry_visa_yes_no
  - Visa number: visa_number
    default: XXX-XXX-XXX
    show if: entry_visa_yes_no
  - Visa category: entry_visa_category
    choices:
      - Visa for flight transit: 'Visum für Flughafentransit (Kategorie A)'
      - Visa for transit: 'Vissum für Durchreise (Kategorie B)'
      - Stay up to 90 days: 'Aufenthalt von bis zu 90 Tagen (Kategorie C)'
      - National Visa: 'Nationales Visum (Kategorie D)'
    default: Stay up to 90 days
    show if: entry_visa_yes_no
  - Visa issued by: visa_issuer
    default: TBD
    show if: entry_visa_yes_no
  - Visa issued date: visa_issued_date
    datatype: date
    show if: entry_visa_yes_no
    default: ${ format_date(today(), format='yyyy-MM-dd') }
  - Visa valid from: visa_valid_from
    datatype: date
    show if: entry_visa_yes_no
    default: ${ format_date(today(), format='yyyy-MM-dd') }
  - Visa valid until: visa_valid_until
    datatype: date
    show if: entry_visa_yes_no
    default: ${ format_date(today(), format='yyyy-MM-dd') }
  - Spatial restriction: visa_spatial_restriction
    choices:
      - Without spatial restriction: ohne räumliche Beschränkung
      - With spatial restriction: beschränkt auf
    show if: entry_visa_yes_no
    default: Without spatial restriction
  - Spatial restriction to: visa_spatial_restriction_details
    show if:
      variable: visa_spatial_restriction
      is: beschränkt auf
  # TODO: Always show? Free text?
  # - Requirement: visa_requirement
  #   show if: entry_visa_yes_no
  #   default: TBD
progress: 60
section: section_arrival
---
segment:
  id: Question Asked
  arguments:
    count: True
    question: Residence
question: |
  Please complete the following questions about your stay in Germany
fields:
  - Current Residence City: residence_current_city
    default: Berlin
  - Purpose of the residence: residence_purpose
    default: Flucht vor Krieg
  - Intended duration of stay: residence_duration
    default: Ende des Kriegs
progress: 70
section: section_stay_germany
---
segment:
  id: Question Asked
  arguments:
    count: True
    question: Address
question: |
  Almost done, complete the following steps before sending
subquestion: |
  Please watch the video below and follow the instructions to find the **right address** to send your application
video: |
  [YOUTUBE YkgkThdzX-8]
fields:
  - Noted right address from the video above as address for application: right_address
    datatype: yesnowide
  - Copied all IDs / passports to add them to the application after download: copy_ids
    datatype: yesnowide
validation code: |
  if not copy_ids:
    validation_error("Please make sure you took a copy of all mentioned IDs / passport to add them to the application.")
  if not right_address:
    validation_error("Please follow the instructions in the video and note down the correct address.")
progress: 70
section: section_checklist